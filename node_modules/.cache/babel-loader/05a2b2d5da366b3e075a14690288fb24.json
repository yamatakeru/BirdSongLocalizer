{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\yamat\\\\Workspace\\\\hark_bird_app\\\\src\\\\components\\\\Main.js\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport Konva from 'konva';\nimport useImage from 'use-image';\nimport { Stage, Layer, Star, Rect, Text, Image } from 'react-konva';\nimport request from \"superagent\";\nimport { UserCount } from '../App';\nimport Reset from './Reset';\nexport const UserLDSelect = createContext();\n\nconst URLImage = props => {\n  const [image] = useImage(props.url);\n  console.log(useImage(props.url));\n  return /*#__PURE__*/React.createElement(Image, {\n    image: image,\n    scaleX: props.scaleX,\n    scaleY: props.scaleY,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 14,\n      columnNumber: 10\n    }\n  });\n};\n\nconst LocalizedRect = props => {\n  const {\n    selectId\n  } = useContext(UserLDSelect);\n  const [id, setId] = useState(props.id);\n  return /*#__PURE__*/React.createElement(Rect, {\n    x: props.x,\n    y: props.y,\n    width: props.width,\n    height: props.height,\n    fill: props.fill,\n    stroke: props.stroke,\n    strokeWidth: props.strokeWidth,\n    onClick: () => {\n      selectId = id;\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 5\n    }\n  });\n};\n\nconst Main = () => {\n  const [count, setCount] = useContext(UserCount);\n  const [img_data, setImgData] = useState(null);\n  const [localized_data, setLocalizedData] = useState([]);\n  const [data_ia_loaded, setDataIsLoaded] = useState(false);\n  const [ldata_ia_loaded, setLDataIsLoaded] = useState(false);\n  const [ldata_is_selected, setLDataIsSelected] = useState(-1);\n\n  const getSpectrumImg = () => {\n    request.get(\"/api/getSpectrumImg\").end((err, data) => {\n      if (err) {\n        console.error(err);\n        return;\n      }\n\n      setImgData(data.body);\n      console.log(img_data);\n      setDataIsLoaded(true);\n      return;\n    });\n  };\n\n  const getLocalizedData = () => {\n    request.get(\"/api/getLocalizedData\").end((err, data) => {\n      if (err) {\n        console.error(err);\n        return;\n      }\n\n      console.log(data.body.localized_data.slice(1));\n      setLocalizedData(data.body.localized_data);\n      setLDataIsLoaded(true);\n      return;\n    });\n  };\n\n  const sendData = () => {\n    request.get(\"/api/sendData\").query({\n      data: -999\n    }).end((err, data) => {\n      if (err) {\n        console.error(err);\n        return;\n      }\n\n      console.log(data.body);\n    });\n  };\n\n  const button_area = () => {\n    if (data_ia_loaded) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"button_area\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        onClick: () => getSpectrumImg(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 11\n        }\n      }, \"load Spectrum\"), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: () => getLocalizedData(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }\n      }, \"load Localized data\"), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: () => setDataIsLoaded(false),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }\n      }, \"resrt data\"));\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"button_area\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        onClick: () => getSpectrumImg(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }\n      }, \"load Spectrum\"));\n    }\n  };\n\n  const stage_area = () => {\n    if (data_ia_loaded) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"stage_area\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"Stage1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 13\n        }\n      }, \"Specgram\"), /*#__PURE__*/React.createElement(Stage, {\n        width: window.innerWidth,\n        height: window.innerHeight / 4,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Layer, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(URLImage //url=\"https://raw.githubusercontent.com/yamatakeru/image_src/master/specgram.png\"\n      , {\n        url: img_data.specgram.img_path,\n        scaleX: 1,\n        scaleY: 0.5,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(Text, {\n        text: \"specgram\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 17\n        }\n      })))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"Stage2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }\n      }, \"Music\"), /*#__PURE__*/React.createElement(Stage, {\n        width: window.innerWidth,\n        height: window.innerHeight / 4,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Layer, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(URLImage //url=\"https://raw.githubusercontent.com/yamatakeru/image_src/master/music.png\"\n      , {\n        url: img_data.music.img_path,\n        scaleX: 1,\n        scaleY: 0.5,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(Text, {\n        text: \"music\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(UserLDSelect.Provider, {\n        value: [ldata_is_selected, setLDataIsSelected],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 15\n        }\n      }, localized_data.slice(1).map(ld => {\n        return /*#__PURE__*/React.createElement(LocalizedRect, {\n          id: ld[0],\n          x: ld[2] / img_data.music.t_max * 992,\n          y: (-ld[4] + 180) / 360 * (740 / 2) - 10,\n          width: ld[3] / img_data.music.t_max * 992,\n          height: 20,\n          fill: \"red\",\n          stroke: \"black\",\n          strokeWidth: 2,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 21\n          }\n        });\n      }))))));\n    } else {\n      return /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 14\n        }\n      }, \" Please date load. \");\n    }\n  };\n\n  const localized_data_area = () => {\n    if (ldata_ia_loaded) {\n      return /*#__PURE__*/React.createElement(\"dev\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 9\n        }\n      }, localized_data.slice(1)[1].map(d => {\n        return /*#__PURE__*/React.createElement(\"ul\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 20\n          }\n        }, d);\n      }));\n    }\n\n    return;\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Main\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 5\n    }\n  }, button_area(), stage_area(), localized_data_area());\n};\n\nexport default Main;","map":{"version":3,"sources":["C:/Users/yamat/Workspace/hark_bird_app/src/components/Main.js"],"names":["React","useState","useEffect","useContext","Konva","useImage","Stage","Layer","Star","Rect","Text","Image","request","UserCount","Reset","UserLDSelect","createContext","URLImage","props","image","url","console","log","scaleX","scaleY","LocalizedRect","selectId","id","setId","x","y","width","height","fill","stroke","strokeWidth","Main","count","setCount","img_data","setImgData","localized_data","setLocalizedData","data_ia_loaded","setDataIsLoaded","ldata_ia_loaded","setLDataIsLoaded","ldata_is_selected","setLDataIsSelected","getSpectrumImg","get","end","err","data","error","body","getLocalizedData","slice","sendData","query","button_area","stage_area","window","innerWidth","innerHeight","specgram","img_path","music","map","ld","t_max","localized_data_area","d"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\r\nimport Konva from 'konva';\r\nimport useImage from 'use-image';\r\nimport { Stage, Layer, Star, Rect, Text, Image } from 'react-konva';\r\nimport request from \"superagent\";\r\nimport { UserCount } from '../App';\r\nimport Reset from './Reset';\r\n\r\nexport const UserLDSelect = createContext();\r\n\r\nconst URLImage = (props) => {\r\n  const [image] = useImage(props.url);\r\n  console.log(useImage(props.url));\r\n  return <Image\r\n    image={image}\r\n    scaleX={props.scaleX}\r\n    scaleY={props.scaleY}\r\n  />;\r\n};\r\n\r\nconst LocalizedRect = (props) => {\r\n  const {selectId} = useContext(UserLDSelect);\r\n  const [id, setId] = useState(props.id);\r\n  return (\r\n    <Rect\r\n      x={props.x}\r\n      y={props.y}\r\n      width={props.width}\r\n      height={props.height}\r\n      fill={props.fill}\r\n      stroke={props.stroke}\r\n      strokeWidth={props.strokeWidth}\r\n      onClick={() => {selectId = id}}\r\n    />\r\n  );\r\n}\r\n\r\nconst Main = () => {\r\n  const [count, setCount] = useContext(UserCount);\r\n  const [img_data, setImgData] = useState(null);\r\n  const [localized_data, setLocalizedData] = useState([]);\r\n  const [data_ia_loaded, setDataIsLoaded] = useState(false);\r\n  const [ldata_ia_loaded, setLDataIsLoaded] = useState(false);\r\n  const [ldata_is_selected, setLDataIsSelected] = useState(-1);\r\n\r\n  const getSpectrumImg = () => {\r\n    request\r\n      .get(\"/api/getSpectrumImg\")\r\n      .end((err, data) => {\r\n        if (err) {\r\n          console.error(err);\r\n          return;\r\n        }\r\n          setImgData(data.body);\r\n          console.log(img_data);\r\n          setDataIsLoaded(true);\r\n          return;\r\n      });\r\n  };\r\n\r\n  const getLocalizedData = () => {\r\n    request\r\n      .get(\"/api/getLocalizedData\")\r\n      .end((err, data) => {\r\n        if (err) {\r\n          console.error(err);\r\n          return;\r\n        }\r\n          console.log(data.body.localized_data.slice(1));\r\n          setLocalizedData(data.body.localized_data);\r\n          setLDataIsLoaded(true);\r\n          return;\r\n      });\r\n  };\r\n\r\n  const sendData = () => {\r\n    request\r\n    .get(\"/api/sendData\")\r\n    .query({data: -999})\r\n    .end((err, data) => {\r\n      if (err) {\r\n        console.error(err);\r\n        return;\r\n      }\r\n        console.log(data.body);\r\n    });\r\n  };\r\n\r\n  const button_area = () => {\r\n    if (data_ia_loaded) {\r\n      return (\r\n        <div className=\"button_area\">\r\n          <button onClick={() => getSpectrumImg()}>\r\n            load Spectrum\r\n          </button>\r\n          <button onClick={() => getLocalizedData()}>\r\n            load Localized data\r\n          </button>\r\n          <button onClick={() => setDataIsLoaded(false)}>\r\n            resrt data\r\n        </button>\r\n      </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <div className=\"button_area\">\r\n          <button onClick={() => getSpectrumImg()}>\r\n            load Spectrum\r\n          </button>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  const stage_area = () => {\r\n    if (data_ia_loaded) {\r\n      return (\r\n        <div className=\"stage_area\">\r\n          <div className=\"Stage1\">\r\n            <p>Specgram</p>\r\n            <Stage width={window.innerWidth} height={window.innerHeight/4}>\r\n              <Layer>\r\n                <URLImage\r\n                  //url=\"https://raw.githubusercontent.com/yamatakeru/image_src/master/specgram.png\"\r\n                  url={img_data.specgram.img_path}\r\n                  scaleX={1}\r\n                  scaleY={0.5}\r\n                />\r\n                <Text text=\"specgram\" />\r\n              </Layer>\r\n            </Stage>\r\n          </div>\r\n          <div className=\"Stage2\">\r\n          <p>Music</p>\r\n          <Stage width={window.innerWidth} height={window.innerHeight/4}>\r\n            <Layer>\r\n              <URLImage\r\n                //url=\"https://raw.githubusercontent.com/yamatakeru/image_src/master/music.png\"\r\n                url={img_data.music.img_path}\r\n                scaleX={1}\r\n                scaleY={0.5}\r\n              />\r\n              <Text text=\"music\" />\r\n              <UserLDSelect.Provider value={[ldata_is_selected, setLDataIsSelected]}>\r\n                {localized_data.slice(1).map(ld => {\r\n                  return (\r\n                    <LocalizedRect\r\n                      id={ld[0]}\r\n                      x={(ld[2] / img_data.music.t_max) * 992}\r\n                      y={((-ld[4] + 180) / 360) * (740 / 2) - 10}\r\n                      width={(ld[3] / img_data.music.t_max) * 992}\r\n                      height={20}\r\n                      fill=\"red\"\r\n                      stroke='black'\r\n                      strokeWidth={2}\r\n                    />\r\n                  )})\r\n                }\r\n              </UserLDSelect.Provider>\r\n            </Layer>\r\n          </Stage>\r\n        </div>\r\n      </div>\r\n      );\r\n    } else {\r\n      return <p> Please date load. </p>;\r\n    }\r\n  };\r\n\r\n  const localized_data_area = () => {\r\n    if (ldata_ia_loaded) {\r\n      return (\r\n        <dev>\r\n          {localized_data.slice(1)[1].map(d => {\r\n            return <ul>{d}</ul>\r\n            })\r\n          }\r\n        </dev>\r\n      );\r\n    }\r\n    return;\r\n  };\r\n\r\n  return (\r\n    <div className=\"Main\">\r\n      {button_area()}\r\n      {stage_area()}\r\n      {localized_data_area()}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Main;\r\n"]},"metadata":{},"sourceType":"module"}