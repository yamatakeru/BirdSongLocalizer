{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\yamat\\\\Workspace\\\\hark_bird_app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import Konva from'konva';import useImage from'use-image';import{Stage,Layer,Star,Rect,Text,Image}from'react-konva';import request from\"superagent\";import{UserCount}from'../App';import Reset from'./Reset';var URLImage=function URLImage(props){var _useImage=useImage(props.url),_useImage2=_slicedToArray(_useImage,1),image=_useImage2[0];console.log(useImage(props.url));return/*#__PURE__*/React.createElement(Image,{image:image,scaleX:props.scaleX,scaleY:props.scaleY});};var LocalizedRect=function LocalizedRect(props){var _useState=useState(props.id),_useState2=_slicedToArray(_useState,2),id=_useState2[0],setId=_useState2[1];return/*#__PURE__*/React.createElement(Rect,{x:props.x,y:props.y,width:props.width,height:props.height,fill:props.fill,stroke:props.stroke,strokeWidth:props.strokeWidth});};var Main=function Main(){var _useContext=useContext(UserCount),_useContext2=_slicedToArray(_useContext,2),count=_useContext2[0],setCount=_useContext2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),img_data=_useState4[0],setImgData=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),localized_data=_useState6[0],setLocalizedData=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),data_ia_loaded=_useState8[0],setDataIsLoaded=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),ldata_ia_loaded=_useState10[0],setLDataIsLoaded=_useState10[1];var _useState11=useState(-1),_useState12=_slicedToArray(_useState11,2),ldata_is_selected=_useState12[0],setLDataIsSelected=_useState12[1];var getSpectrumImg=function getSpectrumImg(){request.get(\"/api/getSpectrumImg\").end(function(err,data){if(err){console.error(err);return;}setImgData(data.body);console.log(img_data);setDataIsLoaded(true);return;});};var getLocalizedData=function getLocalizedData(){request.get(\"/api/getLocalizedData\").end(function(err,data){if(err){console.error(err);return;}console.log(data.body.localized_data.slice(1));setLocalizedData(data.body.localized_data);setLDataIsLoaded(true);return;});};var sendData=function sendData(){request.get(\"/api/sendData\").query({data:-999}).end(function(err,data){if(err){console.error(err);return;}console.log(data.body);});};var button_area=function button_area(){if(data_ia_loaded){return/*#__PURE__*/React.createElement(\"div\",{className:\"button_area\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return getSpectrumImg();}},\"load Spectrum\"),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return getLocalizedData();}},\"load Localized data\"),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return setDataIsLoaded(false);}},\"resrt data\"));}else{return/*#__PURE__*/React.createElement(\"div\",{className:\"button_area\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return getSpectrumImg();}},\"load Spectrum\"));}};var stage_area=function stage_area(){if(data_ia_loaded){return/*#__PURE__*/React.createElement(\"div\",{className:\"stage_area\"},/*#__PURE__*/React.createElement(\"div\",{className:\"Stage1\"},/*#__PURE__*/React.createElement(\"p\",null,\"Specgram\"),/*#__PURE__*/React.createElement(Stage,{width:window.innerWidth,height:window.innerHeight/4},/*#__PURE__*/React.createElement(Layer,null,/*#__PURE__*/React.createElement(URLImage//url=\"https://raw.githubusercontent.com/yamatakeru/image_src/master/specgram.png\"\n,{url:img_data.specgram.img_path,scaleX:1,scaleY:0.5}),/*#__PURE__*/React.createElement(Text,{text:\"specgram\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"Stage2\"},/*#__PURE__*/React.createElement(\"p\",null,\"Music\"),/*#__PURE__*/React.createElement(Stage,{width:window.innerWidth,height:window.innerHeight/4},/*#__PURE__*/React.createElement(Layer,null,/*#__PURE__*/React.createElement(URLImage//url=\"https://raw.githubusercontent.com/yamatakeru/image_src/master/music.png\"\n,{url:img_data.music.img_path,scaleX:1,scaleY:0.5}),/*#__PURE__*/React.createElement(Text,{text:\"music\"}),localized_data.slice(1).map(function(ld){return/*#__PURE__*/React.createElement(LocalizedRect,{id:ld[0],x:ld[2]/img_data.music.t_max*992,y:(-ld[4]+180)/360*(740/2)-10,width:ld[3]/img_data.music.t_max*992,height:20,fill:\"red\",stroke:\"black\",strokeWidth:2});})))));}else{return/*#__PURE__*/React.createElement(\"p\",null,\" Please date load. \");}};var localized_data_area=function localized_data_area(){if(ldata_ia_loaded){return/*#__PURE__*/React.createElement(\"dev\",null,localized_data.slice(1)[1].map(function(d){return/*#__PURE__*/React.createElement(\"ul\",null,d);}));}return;};return/*#__PURE__*/React.createElement(\"div\",{className:\"Main\"},button_area(),stage_area(),localized_data_area());};export default Main;","map":{"version":3,"sources":["C:/Users/yamat/Workspace/hark_bird_app/src/components/Main.js"],"names":["React","useState","useEffect","useContext","Konva","useImage","Stage","Layer","Star","Rect","Text","Image","request","UserCount","Reset","URLImage","props","url","image","console","log","scaleX","scaleY","LocalizedRect","id","setId","x","y","width","height","fill","stroke","strokeWidth","Main","count","setCount","img_data","setImgData","localized_data","setLocalizedData","data_ia_loaded","setDataIsLoaded","ldata_ia_loaded","setLDataIsLoaded","ldata_is_selected","setLDataIsSelected","getSpectrumImg","get","end","err","data","error","body","getLocalizedData","slice","sendData","query","button_area","stage_area","window","innerWidth","innerHeight","specgram","img_path","music","map","ld","t_max","localized_data_area","d"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\r\nimport Konva from 'konva';\r\nimport useImage from 'use-image';\r\nimport { Stage, Layer, Star, Rect, Text, Image } from 'react-konva';\r\nimport request from \"superagent\";\r\nimport { UserCount } from '../App';\r\nimport Reset from './Reset';\r\n\r\n\r\nconst URLImage = (props) => {\r\n  const [image] = useImage(props.url);\r\n  console.log(useImage(props.url));\r\n  return <Image\r\n    image={image}\r\n    scaleX={props.scaleX}\r\n    scaleY={props.scaleY}\r\n  />;\r\n};\r\n\r\nconst LocalizedRect = (props) => {\r\n  const [id, setId] = useState(props.id);\r\n  return (\r\n    <Rect\r\n      x={props.x}\r\n      y={props.y}\r\n      width={props.width}\r\n      height={props.height}\r\n      fill={props.fill}\r\n      stroke={props.stroke}\r\n      strokeWidth={props.strokeWidth}\r\n    />\r\n  );\r\n}\r\n\r\nconst Main = () => {\r\n  const [count, setCount] = useContext(UserCount);\r\n  const [img_data, setImgData] = useState(null);\r\n  const [localized_data, setLocalizedData] = useState([]);\r\n  const [data_ia_loaded, setDataIsLoaded] = useState(false);\r\n  const [ldata_ia_loaded, setLDataIsLoaded] = useState(false);\r\n  const [ldata_is_selected, setLDataIsSelected] = useState(-1);\r\n\r\n  const getSpectrumImg = () => {\r\n    request\r\n      .get(\"/api/getSpectrumImg\")\r\n      .end((err, data) => {\r\n        if (err) {\r\n          console.error(err);\r\n          return;\r\n        }\r\n          setImgData(data.body);\r\n          console.log(img_data);\r\n          setDataIsLoaded(true);\r\n          return;\r\n      });\r\n  };\r\n\r\n  const getLocalizedData = () => {\r\n    request\r\n      .get(\"/api/getLocalizedData\")\r\n      .end((err, data) => {\r\n        if (err) {\r\n          console.error(err);\r\n          return;\r\n        }\r\n          console.log(data.body.localized_data.slice(1));\r\n          setLocalizedData(data.body.localized_data);\r\n          setLDataIsLoaded(true);\r\n          return;\r\n      });\r\n  };\r\n\r\n  const sendData = () => {\r\n    request\r\n    .get(\"/api/sendData\")\r\n    .query({data: -999})\r\n    .end((err, data) => {\r\n      if (err) {\r\n        console.error(err);\r\n        return;\r\n      }\r\n        console.log(data.body);\r\n    });\r\n  };\r\n\r\n  const button_area = () => {\r\n    if (data_ia_loaded) {\r\n      return (\r\n        <div className=\"button_area\">\r\n          <button onClick={() => getSpectrumImg()}>\r\n            load Spectrum\r\n          </button>\r\n          <button onClick={() => getLocalizedData()}>\r\n            load Localized data\r\n          </button>\r\n          <button onClick={() => setDataIsLoaded(false)}>\r\n            resrt data\r\n        </button>\r\n      </div>\r\n      );\r\n    } else {\r\n      return (\r\n        <div className=\"button_area\">\r\n          <button onClick={() => getSpectrumImg()}>\r\n            load Spectrum\r\n          </button>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  const stage_area = () => {\r\n    if (data_ia_loaded) {\r\n      return (\r\n        <div className=\"stage_area\">\r\n          <div className=\"Stage1\">\r\n            <p>Specgram</p>\r\n            <Stage width={window.innerWidth} height={window.innerHeight/4}>\r\n              <Layer>\r\n                <URLImage\r\n                  //url=\"https://raw.githubusercontent.com/yamatakeru/image_src/master/specgram.png\"\r\n                  url={img_data.specgram.img_path}\r\n                  scaleX={1}\r\n                  scaleY={0.5}\r\n                />\r\n                <Text text=\"specgram\" />\r\n              </Layer>\r\n            </Stage>\r\n          </div>\r\n          <div className=\"Stage2\">\r\n          <p>Music</p>\r\n          <Stage width={window.innerWidth} height={window.innerHeight/4}>\r\n            <Layer>\r\n              <URLImage\r\n                //url=\"https://raw.githubusercontent.com/yamatakeru/image_src/master/music.png\"\r\n                url={img_data.music.img_path}\r\n                scaleX={1}\r\n                scaleY={0.5}\r\n              />\r\n              <Text text=\"music\" />\r\n              {localized_data.slice(1).map(ld => {\r\n                return (\r\n                  <LocalizedRect\r\n                    id={ld[0]}\r\n                    x={(ld[2] / img_data.music.t_max) * 992}\r\n                    y={((-ld[4] + 180) / 360) * (740 / 2) - 10}\r\n                    width={(ld[3] / img_data.music.t_max) * 992}\r\n                    height={20}\r\n                    fill=\"red\"\r\n                    stroke='black'\r\n                    strokeWidth={2}\r\n                  />\r\n                )})\r\n              }\r\n            </Layer>\r\n          </Stage>\r\n        </div>\r\n      </div>\r\n      );\r\n    } else {\r\n      return <p> Please date load. </p>;\r\n    }\r\n  };\r\n\r\n  const localized_data_area = () => {\r\n    if (ldata_ia_loaded) {\r\n      return (\r\n        <dev>\r\n          {localized_data.slice(1)[1].map(d => {\r\n            return <ul>{d}</ul>\r\n            })\r\n          }\r\n        </dev>\r\n      );\r\n    }\r\n    return;\r\n  };\r\n\r\n  return (\r\n    <div className=\"Main\">\r\n      {button_area()}\r\n      {stage_area()}\r\n      {localized_data_area()}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Main;\r\n"]},"metadata":{},"sourceType":"module"}