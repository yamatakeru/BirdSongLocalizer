(this.webpackJsonphark_bird_app=this.webpackJsonphark_bird_app||[]).push([[0],{32:function(e,t,n){e.exports=n(91)},36:function(e,t,n){},37:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},38:function(e,t,n){},91:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(30),i=n.n(r),o=(n(36),n(7)),l=(n(37),n(38),n(9)),u=n.n(l),s=(n(14),n(31)),m=n.n(s),d=n(8);n(90);var g=function(e){var t=m()(e.url),n=Object(o.a)(t,1)[0];return c.a.createElement(d.Image,{image:n,x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY,draggable:e.draggable,dragBoundFunc:e.dragBoundFunc})},h=function(e){var t=c.a.useRef(),n=c.a.useRef();return c.a.useEffect((function(){e.isSelected&&(n.current.nodes([t.current]),n.current.getLayer().batchDraw())}),[e.isSelected]),c.a.createElement(c.a.Fragment,null,c.a.createElement(d.Rect,{x:e.x,y:e.y,width:e.width,height:e.height,fill:e.fill,stroke:e.stroke,strokeWidth:e.strokeWidth,opacity:e.opacity,onClick:e.onSelect,onTap:e.onSelect,ref:t,draggable:e.draggable,onDragEnd:function(t){e.onChange(t.target.x(),t.target.y(),t.target.width(),t.target.height())},onDblClick:e.onDblClick,onTransformEnd:function(n){var a=t.current,c=a.scaleX();a.scaleX(1),e.onChange(a.x(),a.y(),Math.max(5,a.width()*c),a.height())}}),e.isSelected&&c.a.createElement(d.Transformer,{ref:n,boundBoxFunc:function(e,t){return t.width<5||t.y!==e.y||t.height!==e.height?e:t}}))},f=function(){var e=Object(a.useContext)(b),t=Object(o.a)(e,2),n=(t[0],t[1],Object(a.useState)(null)),r=Object(o.a)(n,2),i=r[0],l=r[1],s=Object(a.useState)([]),m=Object(o.a)(s,2),f=m[0],p=m[1],E=Object(a.useState)(!1),x=Object(o.a)(E,2),_=x[0],k=x[1],S=Object(a.useState)(!1),y=Object(o.a)(S,2),v=y[0],w=y[1],j=Object(a.useState)(-1),O=Object(o.a)(j,2),C=O[0],F=O[1],L=Object(a.useState)(1),W=Object(o.a)(L,2),D=W[0],I=W[1],N=Object(a.useState)(10),B=Object(o.a)(N,2),z=B[0],R=B[1],X=Object(a.useState)(0),A=Object(o.a)(X,2),M=A[0],Y=A[1],T=Object(a.useState)(!1),G=Object(o.a)(T,2),J=G[0],P=G[1],$=function(){u.a.get("/api/getSpectrumImg").end((function(e,t){e?console.error(e):(l(t.body),k(!0),console.log(t.body))}))},q=function(){u.a.get("/api/getLocalizedData").end((function(e,t){e?console.error(e):(p(t.body.localized_data),w(!0))}))},H=function(){u.a.post("/api/sendAnnotationData").send(f).end((function(e,t){e?console.error(e):console.log(t.body.res)}))},K=function(e,t,n,a){var c=f.slice(0),r=C+1;c[r][2]=String(J?(e-z)/D*(i.music.t_max/992):((e-z)/D+M*i.music.dt_num)*(i.music.t_max/992)),c[r][3]=String(n/D*(i.music.t_max/992)),c[r][4]=String(-(t+10-20)/370*360+180),p(c)},Q=function(e){R(z-(e-D)*i.specgram.t_max/2),I(e)},U=function(e,t){var n=e.x,a="music"===t?20:0;return R(J?n-M*i.music.dt_num*D:n),{x:n,y:a}},V=function(e){Y(e)},Z=function(){var e=f.slice(0);e[C+1][0]=-1,p(e),F(-1)},ee=function(){k(!1),w(!1),F(-1),I(1),R(10),Y(0),P(!1)};return c.a.createElement("div",{className:"Main"},_?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"op_button_area1"},c.a.createElement("button",{onClick:$},"Load Spectrum"),c.a.createElement("button",{onClick:q},"Load Localized Sata"),c.a.createElement("button",{onClick:H},"Save Annotation Sata"),c.a.createElement("button",{onClick:ee},"Resrt")),c.a.createElement("div",{className:"op_button_area2"},c.a.createElement("button",{onClick:function(){return Q(1)}},"x1"),c.a.createElement("button",{onClick:function(){return Q(2)}},"x2"),c.a.createElement("button",{onClick:function(){return Q(4)}},"x4"),c.a.createElement("button",{onClick:function(){return Q(8)}},"x8"),c.a.createElement("button",{onClick:function(){return Q(16)}},"x16"),c.a.createElement("button",{onClick:function(){return V(M-1>=0?M-1:0)}},"--"),c.a.createElement("button",{onClick:function(){return V(M+1<i.music.sp_num?M+1:i.music.sp_num)}},"++"),c.a.createElement("input",{type:"checkbox",checked:J,onChange:function(){P(!J)}}),"relative")):c.a.createElement("div",{className:"button_area1"},c.a.createElement("button",{onClick:$},"Load Spectrum")),_?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"Stage1"},c.a.createElement("p",null,"Specgram x",D,", ",M),c.a.createElement(d.Stage,{width:window.innerWidth,height:370},c.a.createElement(d.Layer,null,c.a.createElement(d.Rect,{x:0,y:0,width:window.innerWidth,height:370,fill:"LightGray"}),c.a.createElement(g,{url:i.specgram.sp_img_paths[M],x:J?z+M*i.music.dt_num*D:z,y:0,scaleX:D,scaleY:.5,draggable:!0,dragBoundFunc:function(e){return U(e,"specgram")}})))),c.a.createElement("div",{className:"Stage2"},c.a.createElement("p",null,"Music"),c.a.createElement(d.Stage,{width:window.innerWidth,height:410},c.a.createElement(d.Layer,null,c.a.createElement(d.Rect,{x:0,y:0,width:window.innerWidth,height:410,fill:"LightGray"}),c.a.createElement(g,{url:i.music.sp_img_paths[M],x:J?z+M*i.music.dt_num*D:z,y:20,scaleX:D,scaleY:.5,draggable:!0,dragBoundFunc:function(e){return U(e,"music")}}),f.slice(1).filter((function(e){return-1!==e[0]&&parseFloat(e[2])>=i.music.t_max/992*M*i.music.dt_num&&parseFloat(e[2])<i.music.t_max/992*(M+2)*i.music.dt_num})).map((function(e){return c.a.createElement(h,{key:"ss"+e[0],x:J?parseFloat(e[2])/i.music.t_max*992*D+z:(parseFloat(e[2])/i.music.t_max*992-M*i.music.dt_num)*D+z,y:(180-parseFloat(e[4]))/360*370-10+20,draggable:parseInt(e[0])===C,width:parseFloat(e[3])/i.music.t_max*992*D,height:20,fill:"red",stroke:"black",strokeWidth:2,opacity:.6,isSelected:parseInt(e[0])===C,onSelect:function(){return F(parseInt(e[0]))},onChange:K,onDblClick:function(){return t=parseInt(e[0]),void new Audio(i.sound_source_paths[t]).play();var t}})})))))):c.a.createElement("p",null,"Please load spectrum data."),function(){if(v&&C>=0){var e=["iid","sid","time","duration","azimuth","species"];return c.a.createElement(c.a.Fragment,null,c.a.createElement("dev",{className:"localized_info"},c.a.createElement("p",null,"Localized Information"),f.slice(1)[C].map((function(t,n){return c.a.createElement("ul",null,e[n],": ",t)}))),c.a.createElement("button",{onClick:Z},"Delete"))}}())},b=Object(a.createContext)(),p=function(){var e=Object(a.useState)(0),t=Object(o.a)(e,2),n=t[0],r=t[1];Object(a.useEffect)((function(){}),[]);return c.a.createElement("div",{className:"App"},c.a.createElement("p",null,"Annotation"),c.a.createElement(b.Provider,{value:[n,r]},c.a.createElement(f,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(p,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[32,1,2]]]);
//# sourceMappingURL=main.18da3775.chunk.js.map